# API Latency Optimizer - Anthropic API Benchmark Configuration
# PRODUCTION-READY configuration for Claude API benchmarking
# Based on comprehensive analysis by Analyst agent (2025-10-02)

name: "anthropic_api_production_benchmark"
description: "Production-ready Anthropic Claude Messages endpoint benchmark with authentication and rate limiting"
output_dir: "./benchmarks/results/anthropic"

# Global settings
environment_variables:
  - ANTHROPIC_API_KEY  # Required: Set via `export ANTHROPIC_API_KEY="sk-ant-..."`

# Tier 1 Safe Load Profile (50 RPM limit for new accounts)
runs:
  - name: "tier1_safe_load"
    description: "Safe load profile for Tier 1 accounts - respects 50 RPM rate limit"
    config:
      target_url: "https://api.anthropic.com/v1/messages"
      total_requests: 50
      concurrency: 5
      timeout: 30s
      request_timeout: 15s
      keep_alive: true
      method: "POST"
      custom_headers:
        x-api-key: "${ANTHROPIC_API_KEY}"
        anthropic-version: "2023-06-01"
        content-type: "application/json"
      body: |
        {
          "model": "claude-3-5-haiku-20250219",
          "max_tokens": 256,
          "messages": [
            {
              "role": "user",
              "content": "Benchmark test: Please respond with 'OK' to confirm successful API call."
            }
          ]
        }
    iterations: 3
    warmup_iterations: 1
    load_pattern: "constant"
    inter_request_delay: "1200ms"

  - name: "tier1_minimal"
    description: "Minimal test for configuration validation - 10 requests only"
    config:
      target_url: "https://api.anthropic.com/v1/messages"
      total_requests: 10
      concurrency: 2
      timeout: 30s
      request_timeout: 15s
      keep_alive: true
      method: "POST"
      custom_headers:
        x-api-key: "${ANTHROPIC_API_KEY}"
        anthropic-version: "2023-06-01"
        content-type: "application/json"
      body: |
        {
          "model": "claude-3-5-haiku-20250219",
          "max_tokens": 128,
          "messages": [
            {
              "role": "user",
              "content": "Test"
            }
          ]
        }
    iterations: 1
    warmup_iterations: 0
    load_pattern: "constant"

  - name: "tier2_moderate_load"
    description: "Moderate load for Tier 2+ accounts (1000 RPM limit) - DISABLED BY DEFAULT"
    enabled: false
    config:
      target_url: "https://api.anthropic.com/v1/messages"
      total_requests: 200
      concurrency: 20
      timeout: 30s
      request_timeout: 15s
      keep_alive: true
      method: "POST"
      custom_headers:
        x-api-key: "${ANTHROPIC_API_KEY}"
        anthropic-version: "2023-06-01"
        content-type: "application/json"
      body: |
        {
          "model": "claude-3-5-haiku-20250219",
          "max_tokens": 256,
          "messages": [
            {
              "role": "user",
              "content": "Benchmark test: Please respond with 'OK'."
            }
          ]
        }
    iterations: 3
    warmup_iterations: 2
    load_pattern: "constant"
    inter_request_delay: "60ms"

# Cost tracking (estimated)
cost_estimate:
  model: "claude-3-5-haiku-20250219"
  input_price_per_1M_tokens: 0.80
  output_price_per_1M_tokens: 4.00
  avg_input_tokens_per_request: 20
  avg_output_tokens_per_request: 50
  tier1_safe_load_cost: "$0.015"
  tier1_minimal_cost: "$0.001"
  tier2_moderate_load_cost: "$0.060"
